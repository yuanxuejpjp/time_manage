{% extends "base.html" %}

{% block title %}ç¼–è¾‘é‡è¦æ—¥å­ - æ—¶é—´æŒæ§è€…{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-header">
                <h4 class="mb-0"><i class="bi bi-pencil"></i> ç¼–è¾‘é‡è¦æ—¥å­</h4>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="mb-3">
                        <label for="title" class="form-label">æ ‡é¢˜ <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="title" name="title"
                               value="{{ imp_date.title }}" required>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="event_date" class="form-label">æ—¥æœŸ <span class="text-danger">*</span></label>
                            <input type="date" class="form-control" id="event_date" name="event_date"
                                   value="{{ imp_date.event_date|date_filter }}" required>
                        </div>
                        <div class="col-md-3">
                            <label for="event_time" class="form-label">æ—¶é—´</label>
                            <input type="time" class="form-control" id="event_time" name="event_time"
                                   value="{{ imp_date.event_time|time_filter if imp_date.event_time else '' }}">
                        </div>
                        <div class="col-md-3">
                            <label for="date_type" class="form-label">ç±»å‹</label>
                            <select class="form-select" id="date_type" name="date_type">
                                <option value="birthday" {% if imp_date.date_type == 'birthday' %}selected{% endif %}>ğŸ‚ ç”Ÿæ—¥</option>
                                <option value="anniversary" {% if imp_date.date_type == 'anniversary' %}selected{% endif %}>ğŸ’ çºªå¿µæ—¥</option>
                                <option value="deadline" {% if imp_date.date_type == 'deadline' %}selected{% endif %}>ğŸ“… æˆªæ­¢æ—¥æœŸ</option>
                                <option value="holiday" {% if imp_date.date_type == 'holiday' %}selected{% endif %}>ğŸ‰ èŠ‚æ—¥</option>
                                <option value="other" {% if imp_date.date_type == 'other' %}selected{% endif %}>ğŸ“Œ å…¶ä»–</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="color" class="form-label">é¢œè‰²æ ‡è®°</label>
                            <select class="form-select" id="color" name="color">
                                <option value="primary" {% if imp_date.color == 'primary' %}selected{% endif %}>è“è‰²</option>
                                <option value="success" {% if imp_date.color == 'success' %}selected{% endif %}>ç»¿è‰²</option>
                                <option value="warning" {% if imp_date.color == 'warning' %}selected{% endif %}>æ©™è‰²</option>
                                <option value="danger" {% if imp_date.color == 'danger' %}selected{% endif %}>çº¢è‰²</option>
                                <option value="info" {% if imp_date.color == 'info' %}selected{% endif %}>é’è‰²</option>
                                <option value="dark" {% if imp_date.color == 'dark' %}selected{% endif %}>ç°è‰²</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="remind_days_before" class="form-label">æå‰æé†’</label>
                            <input type="number" class="form-control" id="remind_days_before" name="remind_days_before"
                                   value="{{ imp_date.remind_days_before }}" min="0" max="30">
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="description" class="form-label">æè¿°</label>
                        <textarea class="form-control" id="description" name="description" rows="2">{{ imp_date.description or '' }}</textarea>
                    </div>

                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-save"></i> ä¿å­˜
                        </button>
                        <a href="{{ url_for('fixed.list_dates') }}" class="btn btn-outline-secondary">å–æ¶ˆ</a>
                        <form method="POST" action="{{ url_for('fixed.complete_date', date_id=imp_date.id) }}">
                            <button type="submit" class="btn btn-outline-{% if imp_date.is_completed %}success{% else %warning{% endif %}">
                                <i class="bi bi-{% if imp_date.is_completed %}check2{% else %clock{% endif %}"></i>
                                {% if imp_date.is_completed %}æ ‡è®°æœªå®Œæˆ{% else %}æ ‡è®°å·²å®Œæˆ{% endif %}
                            </button>
                        </form>
                        <form method="POST" action="{{ url_for('fixed.delete_date', date_id=imp_date.id) }}"
                              onsubmit="return confirm('ç¡®å®šåˆ é™¤æ­¤é‡è¦æ—¥å­ï¼Ÿ')">
                            <button type="submit" class="btn btn-outline-danger">åˆ é™¤</button>
                        </form>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
